# 索引 #

### 单页搜索

当定位到某个页,先到页目录中根据二分法找到对应的分组,遍历对应的分组,便能够找到对应的数据节点
如果搜索条件并非是主键,而是一个普通列,此时将需要遍历整个页中的节点

### 多页查找

首先应该定位到数据所在的页,如果搜索条件是主键值,那么可以遍历所有的页,但是无需遍历页中所有的节点,只需要对页目录中的值进行比较,即能明确数据是否在这个页中,在找到对应页之后,在页目录中使用二分法即能得出结果
但是如果搜索条件并非是主键,此时就需要遍历所有的节点的值来进行比较

即使搜索条件是主键,也还是需要遍历所有的页,此时考虑所有的页都需要从磁盘读取到硬盘之后才能进行比较,那么可以想象这其中所要付出的代价是很大的,此时解决问题的关键是尽量减少读取磁盘的次数

可以看到,如果搜索条件是主键,我们每次读取出数据页只是通过页目录来判断出数据是否在该页中而已,此时我们可以将每个页中主键最小的值抽取出来存放都页中去,这个页中同样存储了一条条记录,不同的是记录中的内容是主键值和页号,我们此时称之为索引项,那么每次从数据库中读取内容无需读取出所有的页,只需读取出存放索引项的页,然后根据条件读取出对应的页后即能查找出记录,这样将大大减少读取磁盘的频率,其实这就是MySQL所采用的方式,称之为索引

### 聚簇索引(按照主键的值进行排序)

- 每一个索引在一个固定的位置都有一个根目录页,刚插入数据时,会插入该根目录页
- 根目录页无法存储新的记录,分配一个新的页,将根目录页的内容复制到新分配的页面,然后根页面用于存储索引项(数据页中最小的主键值+页号)
- 当根页面无法存储新的索引项,此时分配一个新的页面,将根页面的内容复制到这个新的页面,根页面同样用于存储索引项,索引项存储的内容为(索引页中最小的主键值+页号)

####聚簇索引中的内容
- 聚簇索引的排列方式是根据创建表时声明的主键来进行排列的

####使用聚簇索引找寻数据的方式
#####1. 使用前提

只有查询条件中使用到主键才能使用聚簇索引的方式来快速查找数据

#####2. 寻找方式:假设此时索引的高度为3
- 首先在根页面中找到目录所在的索引页
- 在索引页中找到对应的数据页
- 在数据页中找到对应记录
- 上面在页中寻找对应的记录都是先根据页目录找到对应的链表,再遍历对应的分组链表找到对应的记录

### 二级索引

#### 1. 概念

创建普通列的索引称之为二级索引,这个索引中页子节点存储的内容并非是全部的数据,而是索引列和主键值的组合

####2. 使用前提

 查找条件必须使用到创建二级索引的列

####2. 二级索引查找数据过程

- 通过二级目录找到对应的索引列的值,找到与之对应的主键值
- 使用这个主键值进行回表,再到聚簇索引处查找数据


### 联合索引

1. 概念

联合索引其实便是使用多个列(c1,c2)来创建索引,索引的排列方式是先按照c1列进行排列,再按照c2列进行排列
在索引的叶子节点存储的内容为多个列和主键值的组合



## 索引的使用

### 覆盖索引
1. 当通过二级索引来查找数据时,需要进行多次的回表操作,此时可以使用覆盖索引来避免回表的操作

什么是覆盖索引呢?索引列包含了我们所需要结果的列,这个索引就称之为覆盖索引

### 最左前缀原则
1. 建立联合索引能够减少维护一个索引,那么这个联合索引便是一个比较好的索引

什么是最左前缀原则:查询所使用到的列必须与索引声明列的顺序相同,当然只要使用到了即可,使用顺序没有严格要求,是否全部使用也没有要求,这里假如是(c1,c2,c3),查询条件使用了c1,c2是可以的,但是如果使用了c1,c3或者是c2,c3,这个是不符合最左前缀原则的

一句话总结:查询条件所使用到的列必须是索引声明的列中从头开始的连续几个,可以只有一个,也可以包含索引中所有的列
### 索引下推
查询条件不符合最左前缀原则,可以使用索引下推来减少回表的次数



