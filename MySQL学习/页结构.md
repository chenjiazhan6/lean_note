# 数据页结构 #

### 基本概念
-  数据库存储数据的基本单位是页,大小为16KB
###2. 数据页中较为重要的部分

- File Header:页的通用信息
- File Tailer:页的尾部,用于校验页是否完整
- FILE SPACE:空余空间部分
- PAGE DIRECTORY:页目录(大小不确定)
- User Record:用户数据部分
- Infimum + Supremum:两条虚拟记录,最小记录和最大记录

###3. FILE HEADER较为重要的部分

- 校验和
- 页号
- 页类型
- FILE_PAGE_PREV和FILE_PAGE_NEXT:所有的页组成一条双向链表

###4. FILE TAILER

- 前四个字节为页的校验和,与FILE Header中的校验和相对应,数据页在内存进行修改时,要将其写入磁盘,此时在写入磁盘时出现错误,而FILE HEADER中的检验和在整个页面的最前面,最先被读入磁盘,如果在储存过程中出现错误,那么File Header和File Tailer中的检验和就不一致,就能检测出页面出现了错误

###5. 插入数据的基本步骤

- 按照一定的格式,生成一条对应的记录
- 在页的空余空间部分请求空间
- 将记录放置到页中

###6. 记录中较为重要的头信息

- delete_mask:删除位,删除后记录被置为1,之后会被加入到垃链表中去
- hepo_no:当前记录在页中的位置
- record_type:指明当前记录的类型
- next_record:指明下一条记录的偏移位置
- n_owned:指明该组所具有的记录数(数据查找时用到,用于加快查找速度)


###6. 数据查找的方式?(仅限于单页,也就是已经定位到某个页,要在其中找到对应的记录)

- 方法1:对链表遍历一次
- 方法2:创建一个页目录

	- 将所有的记录划分为多个组(包括两条虚拟记录)
	- 每组最后一条记录的n_owned记录了改组具有记录的条数
	- 将每组最后一条的偏移量放置到页目录的槽中(页目录的基本单位),槽中的内容是主键的值
	- 分组要求

		- 最小记录所在组只有一条
		- 最大记录所在组可为1-8条
		- 中间组为4-8条
- 数据查找方法
	
	先通过二分法找到对应的槽,再通过遍历链表,找到对应的数据


###7. 总结

1. 数据页中的数据具有一定的格式,要插入数据时,会从FILE SPACE部分申请空间,然后将数据放置其中,这部分空间便成为User Record部分
2. 插入的数据会组成一条单向链表,按照主键大小从小到大进行连接,Infimum是最小记录,并且在页的固定部分,所以能够从头到尾遍历链表的所有数据
3. 当按照主键查找时,可以使用前面创建的页目录通过二分法快速查找出对应的记录


	
	

